(function(a){var b=a.routers||[],c=a.map=function(a,c){typeof a=="string"&&(a=new RegExp(a)),b.push([a,c])},d=a.route=function(a){a=a||this.page.$url.pathname,a=a.split("?")[0];for(var c=0,d=b.length;c<d;c++)if(b[c][0].test(a))return b[c][1].call(this,this);return!1};return c(/^\/((all|following|from|popular)(\/([^\/]+))?)?\/?$/,function(b){var c=a.view||{};return b.page.show_categories_bar=!b.page.filter||!~b.page.filter.indexOf("site:"),b.render("_index",c,function(a,d){c.show(),b.waterfall=(new Waterfall("waterfall",{loader:b.createCellLoader(b.page.$url.href,20,function(a){return{data:a.pins}})})).reposition()})}),c(/^\/boards\/((all|following|popular)(\/([^\/]+))?)?\/?$/,function(b){var c=a.view||{};return b.page.show_categories_bar=!0,b.render("_index",c,function(a,d){c.show(),b.waterfall=(new Waterfall("waterfall",{loader:b.createCellLoader(b.page.$url.href,20,function(a){return{data:a.boards}})})).reposition()})}),c(/^\/search(\/(pins|boards|people))?\/?$/,function(b){var c=a.view||{};return b.render("_search_result",c,function(a,d){c.show(),b.waterfall=(new Waterfall("waterfall",{loader:b.createCellLoader(b.page.$url.href,20,function(a){var c=b.page.query.type=="people"?"users":b.page.query.type+"s";return{data:a[c]}})})).reposition()})}),c(/^\/pins\/\d+\/?$/,function(b){var c=a.view||{};return b.render("_pin_view",c,function(a,b){c.addClass("view").show()})}),c(/^\/boards\/\d+\/?$/,function(b){var c=a.view||{};return b.page.show_pin_source=!0,b.render("_board_view",c,function(a,d){c.show(),b.page.show_pin_source=!0,b.waterfall=(new Waterfall("waterfall",{loader:b.createCellLoader(b.page.$url.href,20,function(a){return{data:a.board.pins}})})).reposition()})}),c(/^\/boards\/\d+\/followers\/?$/,function(b){var c=a.view||{};return b.render("_people_list",c,function(a,b){c.getElements("div.wrapper").addClass("wfx"),c.addClass("profile").show()})}),c(/^\/bookmarklet\/?$/,function(b){var c=a.view||{};return b.render("_bookmarklet",c,function(a,b){$("bookmarklet").getElement(".pbt").show(),c.show()})}),c(/^\/bookmarklet_success\/?$/,function(b){var c=a.view||{};return b.render("_bookmarklet_success",c,function(a,b){c.show()})}),c(/^\/[a-z0-9-_\.]+\/?$/,function(b){var c=a.view||{};return b.render("_people_boards",c,function(a,d){b.waterfall=(new Waterfall("wrapper",{cellSelector:!1})).reposition(),c.addClass("profile").show()})}),c(/^\/[a-z0-9-_\.]+\/pins\/?$/,function(b){var c=a.view||{};return b.render("_people_pins",c,function(a,d){c.addClass("profile").show(),b.waterfall=(new Waterfall("waterfall",{preservedCols:1,loader:b.createCellLoader(b.page.$url.pathname,20,function(a){var b=a.user.pins;return b.each(function(b){b.user=a.user}),{data:b}})})).reposition()})}),c(/^\/[a-z0-9-_\.]+\/likes\/?$/,function(b){var c=a.view||{};return b.render("_people_likes",c,function(a,d){c.addClass("profile").show(),b.waterfall=(new Waterfall("waterfall",{preservedCols:1,loader:b.createCellLoader(b.page.$url.pathname,20,function(a){return{data:a.user.likes}})})).reposition()})}),c(/^\/[a-z0-9-_\.]+\/followers\/?$/,function(b){var c=a.view||{};return b.render("_people_list",c,function(a,b){c.getElements("div.wrapper").addClass("wfx"),c.addClass("profile").show()})}),c(/^\/[a-z0-9-_\.]+\/following\/?$/,function(b){var c=a.view||{};return b.render("_people_list",c,function(a,b){c.getElements("div.wrapper").addClass("wfx"),c.addClass("profile").show()})}),a})(typeof exports=="undefined"?window.app:exports)