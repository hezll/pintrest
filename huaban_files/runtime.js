(function(){Array.isArray||(Array.isArray=function(a){return"[object Array]"==Object.prototype.toString.call(a)}),Object.keys||(Object.keys=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b}),Object.append||(Object.append=function(a){for(var b=1,c=arguments.length;b<c;b++){var d=arguments[b]||{};for(var e in d)a[e]=d[e]}return a}),String.prototype.len||(String.prototype.len=function(){var a=this.toString(),b=0;for(var c=0;c<a.length;c++){var d=a.charCodeAt(c);d>128?b+=2:b+=1}return b}),String.prototype.brief||(String.prototype.brief=function(a,b){b=b||"...";var c=0,d="";for(var e=0,f=this.length;e<f;e++){var g=this.charCodeAt(e);g>128?c+=2:c+=1;if(c>a)return d+b;d+=this.charAt(e)}return d}),String.prototype.nl2br||(String.prototype.nl2br=function(){return this.replace(/(\r|\n)+/g,"<br/>")})})(),function(){var a,b=/\\?([a-z])/gi,c=["Sun","Mon","Tues","Wednes","Thurs","Fri","Satur","January","February","March","April","May","June","July","August","September","October","November","December"],d=function(a,b){return f[a]?f[a]():b},e=function(a,b){return(a+="").length<b?(new Array(++b-a.length)).join("0")+a:a},f={d:function(){return e(f.j(),2)},D:function(){return f.l().slice(0,3)},j:function(){return a.getDate()},l:function(){return c[f.w()]+"day"},N:function(){return f.w()||7},S:function(){var a=f.j();return a<4|a>20&&["st","nd","rd"][a%10-1]||"th"},w:function(){return a.getDay()},z:function(){var a=new Date(f.Y(),f.n()-1,f.j()),b=new Date(f.Y(),0,1);return Math.round((a-b)/864e5)+1},W:function(){var a=new Date(f.Y(),f.n()-1,f.j()-f.N()+3),b=new Date(a.getFullYear(),0,4);return e(1+Math.round((a-b)/864e5/7),2)},F:function(){return c[6+f.n()]},m:function(){return e(f.n(),2)},M:function(){return f.F().slice(0,3)},n:function(){return a.getMonth()+1},t:function(){return(new Date(f.Y(),f.n(),0)).getDate()},L:function(){var a=f.Y();return a%4==0&a%100!=0|a%400==0},o:function(){var a=f.n(),b=f.W(),c=f.Y();return c+(a===12&&b<9?-1:a===1&&b>9)},Y:function(){return a.getFullYear()},y:function(){return(f.Y()+"").slice(-2)},a:function(){return a.getHours()>11?"pm":"am"},A:function(){return f.a().toUpperCase()},B:function(){var b=a.getUTCHours()*3600,c=a.getUTCMinutes()*60,d=a.getUTCSeconds();return e(Math.floor((b+c+d+3600)/86.4)%1e3,3)},g:function(){return f.G()%12||12},G:function(){return a.getHours()},h:function(){return e(f.g(),2)},H:function(){return e(f.G(),2)},i:function(){return e(a.getMinutes(),2)},s:function(){return e(a.getSeconds(),2)},u:function(){return e(a.getMilliseconds()*1e3,6)},e:function(){throw"Not supported (see source code of date() for timezone on how to add support)"},I:function(){var a=new Date(f.Y(),0),b=Date.UTC(f.Y(),0),c=new Date(f.Y(),6),d=Date.UTC(f.Y(),6);return 0+(a-b!==c-d)},O:function(){var b=a.getTimezoneOffset(),c=Math.abs(b);return(b>0?"-":"+")+e(Math.floor(c/60)*100+c%60,4)},P:function(){var a=f.O();return a.substr(0,3)+":"+a.substr(3,2)},T:function(){return"UTC"},Z:function(){return-a.getTimezoneOffset()*60},c:function(){return"Y-m-d\\Th:i:sP".replace(b,d)},r:function(){return"D, d M Y H:i:s O".replace(b,d)},U:function(){return a/1e3|0}};Date.format=function(c,e){return typeof c=="number"&&(e=c,c="Y-m-d H:i:s"),a=e==null?new Date:e instanceof Date?new Date(e):new Date(e*1e3),c.replace(b,d)},Date.prototype.format=function(a){return Date.format(a,this)}}(),function(){var a={lessThanMinuteAgo:"\u521a\u521a",minuteAgo:"1\u5206\u949f\u524d",minutesAgo:"{delta}\u5206\u949f\u524d",hourAgo:"1\u5c0f\u65f6\u524d",hoursAgo:"{delta}\u5c0f\u65f6\u524d",dayAgo:"\u6628\u5929",daysAgo:"{delta}\u5929\u524d",weekAgo:"1\u5468\u524d",weeksAgo:"{delta}\u5468\u524d",monthAgo:"1\u4e2a\u6708\u524d",monthsAgo:"{delta}\u4e2a\u6708\u524d",yearAgo:"1\u5e74\u524d",yearsAgo:"{delta}\u5e74\u524d",lessThanMinuteUntil:"\u4ece\u73b0\u5728\u5f00\u59cb\u4e0d\u52301\u5206\u949f",minuteUntil:"\u4ece\u73b0\u5728\u5f00\u59cb\u7d041\u5206\u949f",minutesUntil:"\u4ece\u73b0\u5728\u5f00\u59cb\u7ea6{delta}\u5206\u949f",hourUntil:"\u4ece\u73b0\u5728\u5f00\u59cb1\u5c0f\u65f6",hoursUntil:"\u4ece\u73b0\u5728\u5f00\u59cb\u7ea6{delta}\u5c0f\u65f6",dayUntil:"\u4ece\u73b0\u5728\u5f00\u59cb1\u5929",daysUntil:"\u4ece\u73b0\u5728\u5f00\u59cb{delta}\u5929",weekUntil:"\u4ece\u73b0\u5728\u5f00\u59cb1\u661f\u671f",weeksUntil:"\u4ece\u73b0\u5728\u5f00\u59cb{delta}\u661f\u671f",monthUntil:"\u4ece\u73b0\u5728\u5f00\u59cb\u4e00\u4e2a\u6708",monthsUntil:"\u4ece\u73b0\u5728\u5f00\u59cb{delta}\u4e2a\u6708",yearUntil:"\u4ece\u73b0\u5728\u5f00\u59cb1\u5e74",yearsUntil:"\u4ece\u73b0\u5728\u5f00\u59cb{delta}\u5e74"};Date.getTimePhrase=function(a){var b=a<0?"Until":"Ago";a<0&&(a*=-1);var c={minute:60,hour:60,day:24,week:7,month:52/12,year:12,eon:Infinity},d="lessThanMinute";for(var e in c){var f=c[e];if(a<1.5*f){a>.75*f&&(d=e);break}a/=f,d=e+"s"}return a=Math.round(a),{msg:d,delta:a,suffix:b}},Date.timeAgo=function(b){var c=b==null?new Date:b instanceof Date?new Date(b):new Date(b*1e3),d=Math.round((new Date-c)/1e3);if(d>2592e3)return Date.format("Y-m-d H:i:s",c);var e=Date.getTimePhrase(d);return a[e.msg+e.suffix].replace("{delta}",e.delta)},Date.prototype.timeAgo=function(){return Date.timeAgo(this)}}(),function(a){return Object.append(a,{templates:{},attrs:function(b){var c=[],d=b.terse;delete b.terse;var e=Object.keys(b),f=e.length;if(f){c.push("");for(var g=0;g<f;++g){var h=e[g],i=b[h];"boolean"==typeof i||null==i?i&&(d?c.push(h):c.push(h+'="'+h+'"')):"class"==h&&Array.isArray(i)?c.push(h+'="'+a.escape(i.join(" "))+'"'):c.push(h+'="'+a.escape(i)+'"')}}return c.join(" ")},_:function(a){return a?String(a).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"):a},img:function(a,b,c){var d='<img src="'+this.imgURL(a,b)+'"',e=this.imgSize(a,b);d+=' width="'+e.w+'" height="'+e.h+'"';if(c)for(k in c)d+=" "+k+'="'+c[k]+'"';return d+"/>"},imgURL:function(a,b){return"http://"+this.settings.imgHosts[a.bucket]+"/"+a.key+(b?"_"+b:"")},imgSize:function(a,b){if(!b)return{w:a.width,h:a.height};var c,d,e=a.width,f=a.height,g=b.substr(0,2),h=Number(b.substr(2));switch(g){case"sq":c=d=h;break;case"fm":if(h<0||e<h&&f<h)c=e,d=f;else{c=d=h;var i=c/d,j=e/f;i<j?d=Math.round(c/j):c=Math.round(d*j)}break;case"fw":e<h?(c=e,d=f):(c=h,d=Math.round(h*f/e));break;default:}return{w:c,h:d}},avatar:function(a,b){return a.avatar?this.imgURL(a.avatar,b||"sq75"):"/img/default_buddy_icon.jpg"}}),a.escape=a._,a}(typeof exports=="undefined"?window.app:exports)